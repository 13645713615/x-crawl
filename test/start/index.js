"use strict";require("node:path");var e=require("node:http");require("node:fs");var t=require("node:url");function n(e,t){let n=e?`${e}`:"?";if(t)for(const e in t){n+=`&${e}=${t[e]}`}else n=e;return n}function o(e){const{hostname:o,port:r,pathname:a,search:i}=new t.URL(e.url),c={hostname:o,port:r,path:a,search:n(i,e.params),method:e.method.toLocaleUpperCase(),headers:{}};return c.headers=function(e,t){let n;return n="POST"===t.method&&e.data?{...e.headers,"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)}:e.headers,n}(e,c),c}function r(t){return new Promise(((n,r)=>{const a=t.data=JSON.stringify(t.data??""),i=o(t),c=e.request(i,(e=>{const{headers:t}=e,o=[];e.on("data",(e=>o.push(e))),e.on("end",(()=>{const r=Buffer.concat(o),a={headers:t,contentType:e.headers["content-type"],contentLength:e.headers["content-length"],data:r};n(a)}))}));c.on("timeout",(()=>{console.log("Timeout Error"),r(new Error("Timeout"))})),c.on("error",(e=>{console.log("Error: ",e.message),r(e)})),"POST"===i.method&&c.write(a),c.end()}))}(async function(e){const t=await r({url:e,method:"GET",headers:{Location:"/index.html","Access-Control-Allow-Origin":"*",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",Origin:e,"X-FirePHP-Version":"0.0.6","User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36",DNT:1,Referer:"http://wap.17wo.cn/Login.action","Accept-Encoding":"gzip, deflate","Accept-Language":"zh-CN,zh;q=0.8,zh-TW;q=0.6,en;q=0.4,sr;q=0.2"}});return r({url:t.headers.location??"",method:"GET"})})("https://bilibili.com").then((e=>console.log(e.data.toString())));
